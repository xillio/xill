
<html>
<head>
	<link href="_static/default.css" rel="stylesheet" type="text/css" />
</head>
    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="openexcel">
<h1>openexcel</h1>
<p><strong>openexcel (</strong><em>string</em> <strong>filename,</strong> <em>boolean</em> <strong>readonly*)</strong></p>
<div class="section" id="description">
<h2>Description</h2>
<p>Loads the Excel file <code class="docutils literal"><span class="pre">filename</span></code> and returns a workbook object. After loading, you can use <code class="docutils literal"><span class="pre">getsheet</span></code> to open a certain sheet of the workbook. Optionally, XLSX files can be opened as read-only, reducing memory usage. By default <code class="docutils literal"><span class="pre">readonly</span></code> is set to false.</p>
</div>
<div class="section" id="example">
<h2>Example</h2>
<ul>
<li><p class="first">Loading column names from a spreadsheet:</p>
<div class="highlight-python"><div class="highlight"><pre>mappingfile = settings.mapping_file_uri;
mappingbook = null;
mappingsheet = null;

if (fileexists (mappingfile)) {
    mappingbook = openexcel (mappingfile);
}

if (mappingbook != null) {
    mappingsheet = getsheet (mappingbook, &quot;Fieldmappings&quot;);
}

// initialise row and colum numbers //

//...//

//get included columns
column = include_columns_first_column;
row = include_columns_row - 1;
columns = {null, null};

// get column names
while (column &lt; (migrate_column - 1)) {
    if (lowercase (trim (getcell (mappingsheet, column, row + 1))) == &quot;x&quot;) { // only include names that are marked with an x in the next row
        columns[column - 1] = trim (getcell (mappingsheet, column, row), true);
    } else {
        columns[column - 1] = null;
    }
    column = column + 1;
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="tags">
<h2>Tags</h2>
<p><a class="reference internal" href="_tag_excel.html"><em>Excel</em></a></p>
</div>
</div>


          </div>
      </div>

      <div class="clearer"></div>
    </div>
</html>