
<html>
<head>
	<link href="_static/default.css" rel="stylesheet" type="text/css" />
</head>
    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="xpath">
<h1>xpath</h1>
<p><strong>xpath (</strong><em>&lt;void,node,xml&gt;</em> <strong>element</strong>, <em>string</em> <strong>xpath</strong>, <em>list</em> <strong>namespaces*)</strong></p>
<div class="section" id="description">
<h2>Description</h2>
<p>Returns a string, element or a list of XML/HTML-elements from the specified XML/HTML-element as indicated by the string <code class="docutils literal"><span class="pre">xpath</span></code>. This function has full XPath 2.0 support.</p>
<p>For more information about the XPath syntax and available xpath functions look here: <a class="reference external" href="http://www.w3schools.com/xpath/">http://www.w3schools.com/xpath/</a></p>
</div>
<div class="section" id="attention">
<h2>Attention</h2>
<p>When working on subnodes, you typically need to start your xpath with a dot, which tells the system to use the current node rather than the root.</p>
<p>If you refer to elements with a namespace, then you must pass those namespaces in the <code class="docutils literal"><span class="pre">namespaces</span></code> parameter. This also counts for the default namespace if the default namespace in your document is explicitly defined. In this last case you <strong>must</strong> pass this namespace to the <code class="docutils literal"><span class="pre">xpath</span></code> function and use the namespace abbreviation in your <code class="docutils literal"><span class="pre">xpath</span></code> expression (see the last example below.).</p>
</div>
<div class="section" id="details">
<h2>Details</h2>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">xpath</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">/div/a</span></code></td>
<td>all a-tags in all /div tags</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">//a</span></code></td>
<td>every a-tag</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">./&#64;href</span></code></td>
<td>the href attribute of the current tag</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">./text()</span></code></td>
<td>the text held by the current tag</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">//div[contains(&#64;class,</span> <span class="pre">'label')]</span></code></td>
<td>all div elements with a class containing &#8216;label&#8217;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">//div[starts-with(&#64;id,</span> <span class="pre">'ref')]</span></code></td>
<td>all divs where the id attribute starts with &#8216;ref&#8217;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">//hr[&#64;class='edge'</span> <span class="pre">and</span> <span class="pre">position()=1]</span></code></td>
<td>every first hr of &#8216;edge&#8217; class</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">//table[count(tr)=1</span> <span class="pre">and</span> <span class="pre">count(tr/td)=2]</span></code></td>
<td>all tables with 1 row and 2 cols</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">//div/form/parent::*</span></code></td>
<td>all parents of a form under any div</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">//table[parent::div[&#64;class='pad']</span> <span class="pre">and</span> <span class="pre">not(&#64;id)]//a</span></code></td>
<td>any anchor in a table without id, contained in a div of &#8216;pad&#8217; class</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">/html/body/div/*[preceding-sibling::h4]</span></code></td>
<td>any tag after h4</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">//tr/td[font[&#64;class='head'</span> <span class="pre">and</span> <span class="pre">text()='TRACK']]</span></code></td>
<td>all td&#8217;s that have font class set to &#8216;head&#8217; class and text &#8216;TRACK&#8217;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">./table/tr[last()]</span></code></td>
<td>the last row of a table</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">//rdf:Seq/rdf:li/em:id</span></code></td>
<td>using namespaces</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">//a/&#64;href</span></code></td>
<td>hrefs of all anchors</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">//*[count(*)=3]</span></code></td>
<td>all nodes with 3 children</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">//var|//acronym</span></code></td>
<td>all vars and acronyms</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h2>Examples</h2>
<ul>
<li><p class="first">Getting keywords as a string from the meta tags:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">keywords</span> <span class="o">=</span> <span class="n">xpath</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="s">&quot;//meta[@name=&#39;keywords&#39;]/@content&quot;</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">Getting the URL&#8217;s of all images in a page:</p>
<div class="highlight-python"><div class="highlight"><pre>page = loadpage (&quot;http://www.xillio.com&quot;);
links = xpath(page, &quot;//div[@id=&#39;&quot; + settings.content_div_id + &quot;&#39;]//img&quot;);
foreach(_, link, links) {
    url = xpath(link, &quot;./@src&quot;);
    if (variabletype (title) == &quot;list&quot;) {
        url = url[0];
    }
    // ... //
}
</pre></div>
</div>
</li>
<li><p class="first">Getting nodes with namespaces:</p>
<p>Suppose the following code:</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre>xml1 = &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot; standalone=\&quot;no\&quot;?&gt;
&lt;soap:Envelope xmlns:soap=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot; xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot;&gt;
  &lt;soap:Body&gt;
        &lt;GetColumnsResponse xmlns=\&quot;http://schemas.microsoft.com/sharepoint/soap/\&quot;&gt;
          &lt;GetColumnsResult&gt;
                &lt;Fields&gt;
                  &lt;Field name=\&quot;Field1\&quot;/&gt;
                  &lt;Field name=\&quot;Field2\&quot;/&gt;
                  &lt;Field name=\&quot;Field3\&quot;/&gt;
                &lt;/Fields&gt;
          &lt;/GetColumnsResult&gt;
        &lt;/GetColumnsResponse&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;&quot;;

xml1 = stringtoxml(xml1);
fields1 = xpath(xml1, &quot;//myns:Fields/myns:Field&quot;, {myns=&quot;http://schemas.microsoft.com/sharepoint/soap/&quot;});
log(fields1);
</pre></div>
</div>
</div></blockquote>
<p>In this case, on GetColumnsResponse there is a default namespace defined. If this is the case, we must explicitly pass a namespace to the <code class="docutils literal"><span class="pre">xpath</span></code> function, and use that namespace in the <code class="docutils literal"><span class="pre">xpath</span></code> parameter, as shown in the above code sample.
All other namespaces that are used in an xpath expression must be passed in the <code class="docutils literal"><span class="pre">namespaces</span></code> parameter as well. E.g. if you also want to have <code class="docutils literal"><span class="pre">/soap:Envelope/soap:Body</span></code> in the selector, the xpath call would be like this:</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre>fields1 = xpath(xml1, &quot;/zeep:Envelope/zeep:Body/myns:Fields/myns:Field&quot;, {zeep=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;, myns=&quot;http://schemas.microsoft.com/sharepoint/soap/&quot;});
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="tags">
<h2>Tags</h2>
<p><a class="reference internal" href="_tag_xmlhtml.html"><em>XML / HTML</em></a></p>
</div>
</div>


          </div>
      </div>

      <div class="clearer"></div>
    </div>
</html>