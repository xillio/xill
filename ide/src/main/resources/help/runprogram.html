
<html>
<head>
	<link href="_static/default.css" rel="stylesheet" type="text/css" />
</head>
    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="runprogram">
<h1>runprogram</h1>
<p><strong>runprogram (</strong><em>string</em> <strong>program,</strong> <em>&lt;void, list&gt;</em> <strong>arguments)</strong></p>
<div class="section" id="description">
<h2>Description</h2>
<p>Executes the executable file at path <code class="docutils literal"><span class="pre">program</span></code> and passes <code class="docutils literal"><span class="pre">arguments</span></code> as command line arguments. Returns a list variable containing the standard output and error messages.</p>
</div>
<div class="section" id="examples">
<h2>Examples</h2>
<ul>
<li><p class="first">Returning your Java version across Mac, Linux and Windows:</p>
<div class="highlight-python"><div class="highlight"><pre>sysInfo = systeminfo();
path = null;
params = null;
os = sysInfo[&quot;os.name&quot;];

if(contains(os, &quot;Linux&quot;) || contains(os, &quot;Mac&quot;)) {
        path = sysInfo[&quot;java.home&quot;] + &quot;/bin/java&quot;;
} else if(contains(os, &quot;Windows&quot;)) {
        path = sysInfo[&quot;java.home&quot;] + &quot;/bin/java.exe&quot;;
} else {
        log(&quot;Uknown operating system: &quot; + os);
        return();
}

params = {&quot;-version&quot;};

// Run application
if(fileexists(path)){
        log(&quot;Running application with path: \&quot;&quot; + path + &quot;\&quot;&quot;);
        if(params != null) {
                log(listtocsv(runprogram(path,params),&quot; &quot;));
        } else {
                log(listtocsv(runprogram(path),&quot; &quot;));
        }
} else {
        log(&quot;Unable to find application to run at path: &quot; + path);
}
</pre></div>
</div>
</li>
<li><p class="first">Using <code class="docutils literal"><span class="pre">ImageMagick</span></code> to read EXIF data from images:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">imagemagick_result</span> <span class="o">=</span> <span class="n">runprogram</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">bin_path</span> <span class="o">+</span> <span class="s">&quot;\ImageMagick\identify&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;-verbose&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">img</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">});</span>

<span class="n">dimensions</span> <span class="o">=</span> <span class="n">regex</span><span class="p">(</span><span class="n">imagemagick_result</span><span class="o">.</span><span class="n">standard</span><span class="p">,</span> <span class="s">&quot;(?s).*?Geometry: (.*?)x(.*?)\+.*&quot;</span><span class="p">);</span>
<span class="n">filesize</span> <span class="o">=</span> <span class="n">regex</span><span class="p">(</span><span class="n">imagemagick_result</span><span class="o">.</span><span class="n">standard</span><span class="p">,</span> <span class="s">&quot;(?s).*?Filesize: (.*?)</span><span class="se">\n</span><span class="s">.*&quot;</span><span class="p">);</span>
<span class="n">authors</span> <span class="o">=</span> <span class="n">regex</span><span class="p">(</span><span class="n">imagemagick_result</span><span class="o">.</span><span class="n">standard</span><span class="p">,</span> <span class="s">&quot;(?s).*?exif:Artist: (.*?)</span><span class="se">\n</span><span class="s">.*&quot;</span><span class="p">);</span>
<span class="n">copyright</span> <span class="o">=</span> <span class="n">regex</span><span class="p">(</span><span class="n">imagemagick_result</span><span class="o">.</span><span class="n">standard</span><span class="p">,</span> <span class="s">&quot;(?s).*?exif:Copyright: (.*?)</span><span class="se">\n</span><span class="s">.*&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal"><span class="pre">ImageMagick</span></code> is external software, which you have to install separately.</p>
</li>
<li><p class="first">Using <code class="docutils literal"><span class="pre">tidy.exe</span></code> to clean HTML (if the internal function <code class="docutils literal"><span class="pre">tidy()</span></code> is not enough):</p>
<div class="highlight-python"><div class="highlight"><pre>tidyhtml = routine(html)
{
    html = ampersanddecode(html);
    file_in = settings.bin_path + &quot;/temp_in.html&quot;;
    file_out = settings.bin_path + &quot;/temp_out.html&quot;;
    savedata(file_in, html, false);

    command = settings.bin_path + &quot;/tidy.exe&quot;;
    args = {
                        &quot; --input-encoding utf8&quot;,
                        &quot; --output-encoding utf8&quot;,
                        &quot; --output-file &quot; + file_out,
                        &quot; --bare yes&quot;,
                        &quot; --clean yes&quot;,
                        &quot; --drop-font-tags yes&quot;,
                        &quot; --drop-proprietary-attributes yes&quot;,
                        &quot; --enclose-block-text yes&quot;,
                        &quot; --logical-emphasis yes&quot;,
                        &quot; --word-2000 yes&quot;,
                        &quot; --wrap 0&quot;,
                        &quot; --output-xml yes&quot;,
                        file_in
                };
    out = runprogram(command, args);
    html = loaddata(file_out);

    html_body = regex(html, &quot;[\s\S]*?&lt;body&gt;([\s\S]*)&lt;/body&gt;[\s\S]*&quot;);
    return(html_body[1]);
}
</pre></div>
</div>
</li>
<li><p class="first">Quotes used on the commandline are a windows-commandline-only functionality to ensure arguments with spaces are still treated as a single argument. Quotes as such must typically be omitted when using <cite>runprogram</cite> as shown in the example below:</p>
<div class="highlight-python"><div class="highlight"><pre>exiftool.exe -xmp:description=&quot;Opa en oma met kleinkind op bankje op Binnenhof&quot; -xmp-dc:subject=&quot;bankje,binnenhof&quot; -overwrite_original &quot;d:/temp/image.jpg&quot;
</pre></div>
</div>
<p>Translates to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&quot;-xmp:description=Opa en oma met kleinkind op bankje op Binnenhof&quot;</span><span class="p">,</span>
        <span class="s">&quot;-xmp-dc:subject=bankje,binnenhof&quot;</span><span class="p">,</span>
        <span class="s">&quot;-overwrite_original&quot;</span><span class="p">,</span>
        <span class="s">&quot;d:/temp/image.jpg&quot;</span>
<span class="p">};</span>
<span class="n">runprogram</span><span class="p">(</span><span class="s">&quot;exiftool.exe&quot;</span><span class="p">,</span> <span class="n">options</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="tags">
<h2>Tags</h2>
<p><a class="reference internal" href="_tag_other.html"><em>Other</em></a></p>
</div>
</div>


          </div>
      </div>

      <div class="clearer"></div>
    </div>
</html>