
<html>
<head>
	<link href="_static/default.css" rel="stylesheet" type="text/css" />
</head>
    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="foreach">
<h1>foreach</h1>
<p><strong>foreach (</strong><em>string</em> <strong>__key,</strong> <em>string</em> <strong>__value,</strong> <em>any</em> <strong>__list)</strong></p>
<div class="section" id="description">
<h2>Description</h2>
<p>Iterates over all items in the provided list, putting <code class="docutils literal"><span class="pre">key</span></code> and <code class="docutils literal"><span class="pre">value</span></code> into the provided variables. If a non-list variable is provided, the foreach will run once, while putting the value of the variable into the <code class="docutils literal"><span class="pre">value</span></code>. If <code class="docutils literal"><span class="pre">list</span></code> is <code class="docutils literal"><span class="pre">null</span></code>, the foreach construct will not loop at all. By convention an underscore <code class="docutils literal"><span class="pre">_</span></code> is used as first parameter if we do not need to use the <code class="docutils literal"><span class="pre">key</span></code>.</p>
<p>See also <a class="reference internal" href="while.html"><em>while</em></a></p>
</div>
<div class="section" id="examples">
<h2>Examples</h2>
<ul>
<li><p class="first">Looping through a basic list:</p>
<div class="highlight-python"><div class="highlight"><pre>items = {1,2,3,4,5,6,7,8,9};
foreach(_,item,items){
    log(item);
}
</pre></div>
</div>
</li>
<li><p class="first">Looping through an Excel sheet:</p>
<div class="highlight-python"><div class="highlight"><pre>listFromSheet = routine (startrow, columnlist, currentsheet) {
//returns a list of clean URL&#39;s from an Excel spreadsheet identified by index currentsheet, starting at row startrow and looping over columns in columnlist
    result = {null, null};
    index = 0;

    foreach (_, column, columnlist) {
        row = startrow;
        while (row &lt; currentsheet.rows) {
            currentcell = trim (getcell (currentsheet, column, row));
            if ((currentcell != null) &amp;&amp; (startswith (currentcell, &quot;http://&quot;)))  {
                result[index] = replace (currentcell, &quot;/$&quot;, &quot;&quot;); //strip trailinig slash;
                index = index + 1;
            }
            row = row + 1;
        }
    }
    return (result);
}
</pre></div>
</div>
</li>
<li><p class="first">Loop through links on a page:</p>
<div class="highlight-python"><div class="highlight"><pre>// Process links on the page
page = loadpage(&quot;http://www.xillio.com&quot;);
links = xpath(page, &quot;//a&quot;);
foreach(numberinlevel, link, links) {
    // numberinlevel contains a counter counting the links
    url = xpath(link, &quot;./@href&quot;);
    if (variabletype (url) == &quot;list&quot;) {
        url = url[0];
    }
}
</pre></div>
</div>
</li>
<li><p class="first">Compare URL&#8217;s to a list:</p>
<div class="highlight-python"><div class="highlight"><pre>if (fileexists (settings.subset_file_uri)) { // make a list of URL&#39;s that form the subset for this test
    sublist = global (split (loaddata (settings.subset_file_uri), &quot;\r\n&quot;));
    //log (&quot;Subset for test: \n&quot; + sublist);
}

insubset = routine (pageid) {
// returns true if pageid is on the list of URL&#39;s to be included in the test or if it is a sub URL of those on the list.
    url = geturl (pageid);
    if (url != null) {
        if (contains (sublist, url)) {
            return (true); // URL on the list
        } else {
            foreach (index, suburl, sublist) {
                if (contains (url, suburl)) {
                    return (true); // sub URL on the list
                }
            }
        }
        return (false); //url not on the list
    } else { // page does not exist
        return (null);
    }
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="tags">
<h2>Tags</h2>
<p><a class="reference internal" href="_tag_language.html"><em>Language</em></a></p>
</div>
</div>


          </div>
      </div>

      <div class="clearer"></div>
    </div>
</html>