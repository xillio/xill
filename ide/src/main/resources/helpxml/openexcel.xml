<?xml version="1.0" encoding="utf-8"?>
<function Tag="openexcel">
  <name>openexcel</name>
  <parameters>
    <param name="filename,">
      <type>string</type>
    </param>
    <param name="readonly ">
      <type>boolean</type>
    </param>
  </parameters>
  <description><![CDATA[Loads the Excel file filename and returns a workbook object. After loading, you can use getsheet to open a certain sheet of the workbook. Optionally, XLSX files can be opened as read-only, reducing memory usage. By default readonly is set to false.]]></description>
  <examples>
    <example description="Loading column names from a spreadsheet:"><![CDATA[mappingfile = settings.mapping_file_uri;
mappingbook = null;
mappingsheet = null;
]]></example>
    <example description="if (fileexists (mappingfile)) {"><![CDATA[    mappingbook = openexcel (mappingfile);
}
]]></example>
    <example description="if (mappingbook != null) {"><![CDATA[    mappingsheet = getsheet (mappingbook, "Fieldmappings");
}
]]></example>
    <example description="// initialise row and colum numbers //"><![CDATA[]]></example>
    <example description="//...//"><![CDATA[]]></example>
    <example description="//get included columns"><![CDATA[column = include_columns_first_column;
row = include_columns_row - 1;
columns = {null, null};
]]></example>
    <example description="// get column names"><![CDATA[while (column < (migrate_column - 1)) {
    if (lowercase (trim (getcell (mappingsheet, column, row + 1))) == "x") { // only include names that are marked with an x in the next row
        columns[column - 1] = trim (getcell (mappingsheet, column, row), true);
    } else {
        columns[column - 1] = null;
    }
    column = column + 1;
}
]]></example>
  </examples>
  <Applications />
  <tags>
    <tag>Excel</tag>
  </tags>
</function>