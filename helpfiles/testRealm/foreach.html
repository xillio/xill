<head><title>foreach</title><link type="text/css" href="../_static/default.css" rel="stylesheet"/></head><body><div class="Section"><h1>foreach</h1></div><div class="Section"><p><strong>foreach</strong>(string  __key,, string  __value,, any  __list)</p></div><div class="Section"><h2>Description</h2><p>Iterates over all items in the provided list, putting key and value into the provided variables. If a non-list variable is provided, the foreach will run once, while putting the value of the variable into the value. If list is null, the foreach construct will not loop at all. By convention an underscore _ is used as first parameter if we do not need to use the key.</p></div><div class="Examples"><h2>Examples</h2><ul><li><p class="First">Looping through a basic list:</p><div class="highlight"><pre>items = {1,2,3,4,5,6,7,8,9};
foreach(_,item,items){
    log(item);
}
</pre></div></li><li><p class="First">Looping through an Excel sheet:</p><div class="highlight"><pre>listFromSheet = routine (startrow, columnlist, currentsheet) {
//returns a list of clean URL's from an Excel spreadsheet identified by index currentsheet, starting at row startrow and looping over columns in columnlist
    result = {null, null};
    index = 0;
</pre></div></li><li><p class="First">    foreach (_, column, columnlist) {</p><div class="highlight"><pre>        row = startrow;
        while (row &lt; currentsheet.rows) {
            currentcell = trim (getcell (currentsheet, column, row));
            if ((currentcell != null) &amp;&amp; (startswith (currentcell, &quot;http://&quot;)))  {
                result[index] = replace (currentcell, &quot;/$&quot;, &quot;&quot;); //strip trailinig slash;
                index = index + 1;
            }
            row = row + 1;
        }
    }
    return (result);
}
</pre></div></li><li><p class="First">Loop through links on a page:</p><div class="highlight"><pre>// Process links on the page
page = loadpage(&quot;http://www.xillio.com&quot;);
links = xpath(page, &quot;//a&quot;);
foreach(numberinlevel, link, links) {
    // numberinlevel contains a counter counting the links
    url = xpath(link, &quot;./@href&quot;);
    if (variabletype (url) == &quot;list&quot;) {
        url = url[0];
    }
}
</pre></div></li><li><p class="First">Compare URL&rsquo;s to a list:</p><div class="highlight"><pre>if (fileexists (settings.subset_file_uri)) { // make a list of URL's that form the subset for this test
    sublist = global (split (loaddata (settings.subset_file_uri), &quot;\r\n&quot;));
    //log (&quot;Subset for test: \n&quot; + sublist);
}
</pre></div></li><li><p class="First">insubset = routine (pageid) {</p><div class="highlight"><pre>// returns true if pageid is on the list of URL's to be included in the test or if it is a sub URL of those on the list.
    url = geturl (pageid);
    if (url != null) {
        if (contains (sublist, url)) {
            return (true); // URL on the list
        } else {
            foreach (index, suburl, sublist) {
                if (contains (url, suburl)) {
                    return (true); // sub URL on the list
                }
            }
        }
        return (false); //url not on the list
    } else { // page does not exist
        return (null);
    }
}
</pre></div></li></ul></div><div class="Tags"><h2>Tags</h2><ul><li><p><a href="../testRealm/ while.html"> while</a></p></li><li><p><a href="../testRealm/Language.html">Language</a></p></li></ul></div></body>