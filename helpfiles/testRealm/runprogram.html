<head><title>runprogram</title><link type="text/css" href="_static/default.css" rel="stylesheet"/></head><body><div class="Section"><h1>runprogram</h1></div><div class="Section"><p><strong>runprogram</strong>(string  program,, &lt;void,  list&gt;)</p></div><div class="Section"><h2>Description</h2><p>Executes the executable file at path program and passes arguments as command line arguments. Returns a list variable containing the standard output and error messages.</p></div><div class="Examples"><h2>Examples</h2><ul><li><p class="First">Returning your Java version across Mac, Linux and Windows:</p><div class="highlight"><pre>sysInfo = systeminfo();
path = null;
params = null;
os = sysInfo[&quot;os.name&quot;];
</pre></div></li><li><p class="First">if(contains(os, &quot;Linux&quot;) || contains(os, &quot;Mac&quot;)) {</p><div class="highlight"><pre>        path = sysInfo[&quot;java.home&quot;] + &quot;/bin/java&quot;;
} else if(contains(os, &quot;Windows&quot;)) {
        path = sysInfo[&quot;java.home&quot;] + &quot;/bin/java.exe&quot;;
} else {
        log(&quot;Uknown operating system: &quot; + os);
        return();
}
</pre></div></li><li><p class="First">params = {&quot;-version&quot;};</p><div class="highlight"><pre></pre></div></li><li><p class="First">// Run application</p><div class="highlight"><pre>if(fileexists(path)){
        log(&quot;Running application with path: \&quot;&quot; + path + &quot;\&quot;&quot;);
        if(params != null) {
                log(listtocsv(runprogram(path,params),&quot; &quot;));
        } else {
                log(listtocsv(runprogram(path),&quot; &quot;));
        }
} else {
        log(&quot;Unable to find application to run at path: &quot; + path);
}
</pre></div></li><li><p class="First">Using ImageMagick to read EXIF data from images:</p><div class="highlight"><pre>imagemagick_result = runprogram(settings.bin_path + &quot;\ImageMagick\identify&quot;, {&quot;-verbose&quot;, &quot;\&quot;&quot; + img + &quot;\&quot;&quot;});
</pre></div></li><li><p class="First">dimensions = regex(imagemagick_result.standard, &quot;(?s).*?Geometry: (.*?)x(.*?)\+.*&quot;);</p><div class="highlight"><pre>filesize = regex(imagemagick_result.standard, &quot;(?s).*?Filesize: (.*?)\n.*&quot;);
authors = regex(imagemagick_result.standard, &quot;(?s).*?exif:Artist: (.*?)\n.*&quot;);
copyright = regex(imagemagick_result.standard, &quot;(?s).*?exif:Copyright: (.*?)\n.*&quot;);
</pre></div></li><li><p class="First">Note that ImageMagick is external software, which you have to install separately.</p><div class="highlight"><pre></pre></div></li><li><p class="First">Using tidy.exe to clean HTML (if the internal function tidy() is not enough):</p><div class="highlight"><pre>tidyhtml = routine(html)
{
    html = ampersanddecode(html);
    file_in = settings.bin_path + &quot;/temp_in.html&quot;;
    file_out = settings.bin_path + &quot;/temp_out.html&quot;;
    savedata(file_in, html, false);
</pre></div></li><li><p class="First">    command = settings.bin_path + &quot;/tidy.exe&quot;;</p><div class="highlight"><pre>    args = {
                        &quot; --input-encoding utf8&quot;,
                        &quot; --output-encoding utf8&quot;,
                        &quot; --output-file &quot; + file_out,
                        &quot; --bare yes&quot;,
                        &quot; --clean yes&quot;,
                        &quot; --drop-font-tags yes&quot;,
                        &quot; --drop-proprietary-attributes yes&quot;,
                        &quot; --enclose-block-text yes&quot;,
                        &quot; --logical-emphasis yes&quot;,
                        &quot; --word-2000 yes&quot;,
                        &quot; --wrap 0&quot;,
                        &quot; --output-xml yes&quot;,
                        file_in
                };
    out = runprogram(command, args);
    html = loaddata(file_out);
</pre></div></li><li><p class="First">    html_body = regex(html, &quot;[\s\S]*?&lt;body&gt;([\s\S]*)&lt;/body&gt;[\s\S]*&quot;);</p><div class="highlight"><pre>    return(html_body[1]);
}
</pre></div></li><li><p class="First">Quotes used on the commandline are a windows-commandline-only functionality to ensure arguments with spaces are still treated as a single argument. Quotes as such must typically be omitted when using runprogram as shown in the example below:</p><div class="highlight"><pre>exiftool.exe -xmp:description=&quot;Opa en oma met kleinkind op bankje op Binnenhof&quot; -xmp-dc:subject=&quot;bankje,binnenhof&quot; -overwrite_original &quot;d:/temp/image.jpg&quot;
</pre></div></li><li><p class="First">Translates to:</p><div class="highlight"><pre>options = {
        &quot;-xmp:description=Opa en oma met kleinkind op bankje op Binnenhof&quot;,
        &quot;-xmp-dc:subject=bankje,binnenhof&quot;,
        &quot;-overwrite_original&quot;,
        &quot;d:/temp/image.jpg&quot;
};
runprogram(&quot;exiftool.exe&quot;, options);
</pre></div></li></ul></div><div class="Tags"><h2>Tags</h2><ul><li><p><a href="Other.html">Other</a></p></li></ul></div></body>